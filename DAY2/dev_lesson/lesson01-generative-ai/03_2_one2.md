# 生成AIが作ったフローを改修

先ほど作ったフローを少し改善してみましょう。

## ここでやること: 「超音波距離センサーで距離を測ってLEDのオンオフ制御」を生成AIを使って分かりやすい構成に書き換える
ひとつ前の演習の内容を扱います。

前の演習でうまくいかなかった人はこちらの JSON を読み込んでください
```JSON
[ { "id": "obniz_repeat", "type": "obniz-repeat", "z": "flow-id", "interval": "1000", "name": "Obniz Repeat", "code": "msg.payload = await obnizParts.hcsr04.measureWait();\nreturn msg;", "outputs": 1, "noerr": 0, "x": 210, "y": 160, "wires": [ [ "function_node" ] ] }, { "id": "function_node", "type": "function", "z": "flow-id", "name": "Threshold Check", "func": "if(msg.payload <= 200){\n    msg.payload = true;\n} else {\n    msg.payload = false;\n}\nreturn msg;", "outputs": 1, "noerr": 0, "x": 430, "y": 160, "wires": [ [ "obniz_function" ] ] }, { "id": "obniz_function", "type": "obniz-function", "z": "flow-id", "name": "LED Control", "code": "if(msg.payload){\n    obnizParts.led.on();\n} else {\n    obnizParts.led.off();\n}", "outputs": 1, "noerr": 0, "x": 660, "y": 160, "wires": [] } ]
```

具体的には`Functionノード`をやめて`Switchノード`を使う構成にしてみます。

> <img src="https://i.gyazo.com/f5dd60a927ca83975a814d6ffd67665a.png" width="400px" />


### 配線準備

超音波距離センサーと LED を配線します。

> 前のページと同様で大丈夫です。
> 
> <img src="https://i.gyazo.com/91fb4bbfc54848ecf60f22344cae6905.jpg" width="400px" />

## 2. 演習: Effibot に追加指示を出して`functionノード`を`switchノード`に変更

> <img src="https://i.gyazo.com/b190b7dc696a22413b9958d27b0cb8b6.png" width="400px" />

既存のやりとりのあとに以下のように追加指示を出しますが、Effibot は前回の文脈を覚えていてくれるので、今回は簡単な言葉でも良い出力をしてくれる可能性が高いです。

```
現状、中間の条件分岐がfunctionノードになっていますが、視覚的に分かりやすいように、switchノードに変更し、obniz functionノードも LED の ON と OFF で二つに分けてください。
```

割と一発で良い結果がでることが多かったですが、うまくいかない場合はまた追加で Effibot に注文を出して改善してみましょう。

> <img src="https://i.gyazo.com/86e17b60d55bd21984560615dc51272f.png" width="400px" />

  
----

**[◀ 目次ページに戻る](../readme.md)**
