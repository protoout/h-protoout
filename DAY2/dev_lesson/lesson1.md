# IoTの全体像

## 概要

IoT(Internet of Things)とは、さまざまなモノ(デバイス)がインターネットにつながり、データをやり取りすることで新しいサービスや価値を生み出すコンセプトです。IoTの全体像は、ネットワーク、デバイス、アプリケーションの3つの要素から構成されています。

## 要素間の関係性

<img src="https://i.gyazo.com/6efed8819c6ec78a1c9463b3f64aa881.png" />


### ネットワーク

IoTシステムでは、モノ（デバイス）とアプリケーションを接続するネットワークが不可欠です。デバイスからのデータは、有線または無線のネットワークを経由してクラウドに送信されます。

### デバイス

デバイスは、みなさんが使っているiPadやスマートフォンのようなものから、センサーやアクチュエータまでさまざまなものがあります。デバイスは、周囲の環境データを収集したり、アプリケーションからの命令に応じて動作したりします。収集したデータはネットワークを介してアプリケーションに送信されます。

### アプリケーション

IoTシステムの中核を担います。アプリケーションは、デバイスからのデータを収集・蓄積し、機械学習などによってデータ分析を行います。分析結果に基づいて、デバイスへの制御命令を送信したり、ユーザーインターフェースを提供したりします。

## 全体像のまとめ

IoTの全体像は、以下のようなデータフローで表すことができます。

1. デバイスが環境データを収集
2. デバイスからデータをネットワークを介してクラウドに送信
3. クラウド上のアプリケーションでデータを処理・分析
4. 分析結果に基づいてデバイスへ制御命令を送信
5. デバイスが制御命令にしたがって動作

このように、ネットワーク、デバイス、アプリケーションが有機的に連携することで、IoTシステムが機能します。これらの要素が適切に設計・構築されることで、新しいサービスやソリューションが実現できます。

必要な知識が多岐にわたり、IT界隈における総合格闘技と言われています。

今回は...

# ネットワークについてもうすこし深堀り

要件に合わせて、どんな技術、通信方法を選択するのかが大切！

- 電源がある環境ですか？
- ●●●
- ●●●

## いろいろな無線通信規格

### Wi-Fi


### LTE (Long Term Evolution)


### LPWA (Low Power Wide Area)  
- Wi-FiやLTEと比較して、**低消費電力**で広範囲をカバーできる無線通信技術の総称


## その他の通信方式


### シリアル通信


### Bluetooth


## ネットワークプロトコル

### TCP/IP


#### HTTP (HyperText Transfer Protocol)


#### **MQTT (Message Queuing Telemetry Transport)**


#### **WebSocket**



obnizはWi-Fiに接続し、WebSocketによりリアルタイムなデータ送受信を可能にしています。Bluetoothも利用ができます。



### MQTTで大切な4つの用語

本屋さん、作家さん、購読者、作者名が書いてある棚

- MQTTブローカー:
MQTTブローカーは、クライアント間のメッセージングを仲介するサーバーです。ブローカーはメッセージを受け取り、サブスクライバーにメッセージを転送します。また、パブリッシャーから受け取ったメッセージを適切なサブスクライバーに送信します。ブローカーは通常、パブリッシュ/サブスクライブのトラフィックを管理し、セキュリティや認証などの機能も提供します。

- トピック:
トピックは、メッセージがパブリッシュされたりサブスクライブされたりする場所を識別するための識別子です。例えば、"home/temperature"や"sensor/data"のようなものです。トピックは階層的な構造を持つことができ、ワイルドカードを使って複数のトピックを一度に指定することもできます。

- Publish (パブリッシュ):
パブリッシュは、メッセージをブローカーに送信する操作です。クライアントが特定のトピックにメッセージを送信すると、ブローカーはそのメッセージを受け取り、適切なサブスクライバーに送信します。

- Subscribe (サブスクライブ):
サブスクライブは、特定のトピックに対するメッセージを受信するための操作です。クライアントはブローカーに対して特定のトピックに対してサブスクライブすることで、そのトピックに関連するメッセージを受信できます。



## 考えてみよう


### 1. お家に設置した太陽光発電システムの発電量をリアルタイムに取得しスマートフォンから見られるようにする

回答 ※ 正解ということではなく、あくまでも1つの例です
- 電源: コンセントからとる
- ネットワーク: 家のWi-Fiに接続
発電量を取得してMQTTブローカーにパブリッシュし、スマートフォン側からそのデータをサブスクライブする。



### 2. キャッシュレス決済付きの自販機をつくるとき、どんな通信規格をつかう...？

回答 ※ 正解ということではなく、あくまでも1つの例です
- 電源: コンセントからとる
- ネットワーク: LTEかLPWA
決済時、スマートフォンでタッチ→ HTTPでペイメントシステムにリクエスト→ 決済が成功したレスポンスが返ってくる→ 飲み物が出る




## MQTT使わなくてもobnizだけでやりたいことできてない...？というギモンについて

obnizはWebsocketという通信プロトコルを採用し、リアルタイムなデータのやり取りを実現しています。

WebSocketは、双方向の通信を可能にするプロトコルで、主な目的はWebブラウザとサーバー間でのリアルタイムな双方向通信を実現することです。たとえば、チャットアプリケーションやオンラインゲームで利用されます。

https://mosquitto.org/